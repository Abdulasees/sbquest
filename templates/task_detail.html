{% extends 'base_public.html' %}

{% block title %}{{ task.title }} | Quiz{% endblock %}

{% block content %}
<div class="container" style="padding:40px; max-width:700px; margin:auto; background:#fff; border-radius:12px; box-shadow:0 6px 20px rgba(0,0,0,0.1);">
    <h1 style="text-align:center; margin-bottom:25px;">{{ task.title }}</h1>

    {% if quiz %}
        <div class="question-number" style="text-align:right; color:#555; font-size:15px; margin-bottom:10px;">
            Question {{ question_number }} of {{ total_questions }}
        </div>

        <fieldset style="border:none; padding:0;">
            <legend class="question-box" style="background:linear-gradient(135deg,#007bff,#0056b3); color:#fff; padding:18px; font-size:20px; border-radius:8px; font-weight:bold; box-shadow:0 3px 10px rgba(0,0,0,0.15);">
                {{ question.text }}
                {% if question.image %}
                    <img src="{{ question.image.url }}" alt="Question image" style="max-width:300px; display:block; margin-top:10px; border-radius:6px;">
                {% endif %}
            </legend>

            {% if error %}
                <div class="error-message" style="color:red; font-weight:bold; margin-bottom:15px;">{{ error }}</div>
            {% endif %}

            <form method="post">
                {% csrf_token %}
                <div class="answers">
                    {% for answer in answers %}
                        <label style="display:block; background:#f8f9fa; padding:12px; margin-bottom:12px; border-radius:6px; font-size:17px; cursor:pointer; border:1px solid #ddd; transition:all 0.2s;">
                            <input type="radio" name="answer" value="{{ answer.id }}" 
                                {% if previous_selection == answer.id %}checked{% endif %}>
                            {{ answer.text }}
                            {% if answer.image %}
                                <img src="{{ answer.image.url }}" alt="{{ answer.text }}" style="max-width:150px; display:block; margin-top:5px;">
                            {% endif %}
                        </label>
                    {% endfor %}
                </div>

                <div class="nav-buttons" style="display:flex; justify-content:space-between; margin-top:15px;">
                    {% if question_number > 1 %}
                        <button type="submit" name="back" class="btn btn-secondary" style="background:#6c757d; color:#fff; padding:10px 20px; border-radius:5px; border:none; cursor:pointer;">← Back</button>
                    {% else %}
                        <span></span>
                    {% endif %}

                    {% if question_number < total_questions %}
                        <button type="submit" name="next" class="btn" style="background:#28a745; color:#fff; padding:10px 20px; border-radius:5px; border:none; cursor:pointer;">Next →</button>
                    {% else %}
                        <button type="submit" name="finish" class="btn" style="background:#28a745; color:#fff; padding:10px 20px; border-radius:5px; border:none; cursor:pointer;">Finish Quiz</button>
                    {% endif %}
                </div>
            </form>
        </fieldset>
    {% else %}
        <p style="text-align:center; color:#777;"><em>No quiz linked to this task.</em></p>
    {% endif %}

    <a href="{% url 'tasks:task_list' %}" class="back-link" style="display:block; text-align:center; color:#007bff; margin-top:30px; text-decoration:none;">← Back to Task List</a>
</div>
{% endblock %}
