{% extends 'base_public.html' %}

{% block content %}
<h2>Get in Touch</h2>

{% if messages %}
    {% for message in messages %}
        <p class="{% if message.tags %}{{ message.tags }}{% endif %}">{{ message }}</p>
    {% endfor %}
{% endif %}

<form method="post">
    {% csrf_token %}
    <input type="text" name="name" placeholder="Your Name" required>
    <input type="email" name="email" placeholder="Your Email" required>
    <input type="text" name="subject" placeholder="Subject" required>
    <textarea name="message" rows="5" placeholder="Your Message" required></textarea>
    <button type="submit">Send Message</button>
</form>

<h2>Your Previous Messages</h2>
{% if contact_messages %}
    {% for msg in contact_messages %}
        <div class="message-box">
            <strong>Subject:</strong> {{ msg.subject }} <br>
            <strong>Message:</strong> {{ msg.message }} <br>
            <strong>Sent:</strong> {{ msg.created_at|date:"d M Y H:i" }} <br>
            {% if msg.reply %}
                <div class="reply">
                    <strong>Admin Reply:</strong> {{ msg.reply }} <br>
                    <strong>Replied At:</strong> {{ msg.replied_at|date:"d M Y H:i" }}
                </div>
            {% else %}
                <em>No reply yet.</em>
            {% endif %}
        </div>
    {% endfor %}
{% else %}
    <p>You havenâ€™t sent any messages yet.</p>
{% endif %}
{% endblock %}
